# é…ç½®ä½¿ç”¨ IP åœ°å€ 120.55.70.199 è®¿é—®

## ğŸš€ å¿«é€Ÿé…ç½®

### æ–¹æ³• 1ï¼šä½¿ç”¨ sed å¿«é€Ÿä¿®æ”¹ï¼ˆæ¨èï¼‰

```bash
# ä¿®æ”¹ Nginx é…ç½®ï¼Œä½¿ç”¨ä¸‹åˆ’çº¿ _ åŒ¹é…æ‰€æœ‰è®¿é—®ï¼ˆåŒ…æ‹¬ IP å’ŒåŸŸåï¼‰
sudo sed -i 's/server_name.*;/server_name _;/' /etc/nginx/sites-available/qk-paper-search

# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡æ–°åŠ è½½ Nginx
sudo systemctl reload nginx
```

### æ–¹æ³• 2ï¼šæ‰‹åŠ¨ç¼–è¾‘é…ç½®æ–‡ä»¶

```bash
# ç¼–è¾‘é…ç½®æ–‡ä»¶
sudo vi /etc/nginx/sites-available/qk-paper-search
# æˆ–
sudo nano /etc/nginx/sites-available/qk-paper-search
```

æ‰¾åˆ° `server_name` è¡Œï¼Œä¿®æ”¹ä¸ºï¼š

```nginx
server_name _;
```

æˆ–è€…ï¼š

```nginx
server_name 120.55.70.199;
```

ä¿å­˜åï¼š
```bash
sudo nginx -t && sudo systemctl reload nginx
```

## ğŸ“ å®Œæ•´é…ç½®ç¤ºä¾‹

ä½ çš„ Nginx é…ç½®åº”è¯¥æ˜¯è¿™æ ·çš„ï¼š

```nginx
server {
    listen 80;
    server_name _;  # æˆ– server_name 120.55.70.199;

    client_max_body_size 100M;

    location / {
        proxy_pass http://127.0.0.1:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        
        proxy_connect_timeout 300s;
        proxy_send_timeout 300s;
        proxy_read_timeout 300s;
    }

    location /static {
        alias /opt/qk/static;
        expires 30d;
        add_header Cache-Control "public, immutable";
    }

    access_log /var/log/nginx/qk-paper-search-access.log;
    error_log /var/log/nginx/qk-paper-search-error.log;
}
```

## âœ… é…ç½®å®Œæˆåè®¿é—®

é…ç½®å®Œæˆåï¼Œåœ¨æµè§ˆå™¨è®¿é—®ï¼š

```
http://120.55.70.199
```

## ğŸ” éªŒè¯é…ç½®

### 1. æ£€æŸ¥é…ç½®æ˜¯å¦æ­£ç¡®

```bash
# æŸ¥çœ‹å½“å‰é…ç½®
sudo cat /etc/nginx/sites-available/qk-paper-search | grep server_name

# æµ‹è¯•é…ç½®è¯­æ³•
sudo nginx -t
```

### 2. æ£€æŸ¥æœåŠ¡çŠ¶æ€

```bash
# æ£€æŸ¥åº”ç”¨æœåŠ¡
sudo systemctl status qk-paper-search

# æ£€æŸ¥ Nginx æœåŠ¡
sudo systemctl status nginx

# æ£€æŸ¥ç«¯å£ç›‘å¬
sudo netstat -tlnp | grep -E ":(80|8000)"
```

### 3. æµ‹è¯•æœ¬åœ°è®¿é—®

```bash
# åœ¨æœåŠ¡å™¨ä¸Šæµ‹è¯•
curl http://127.0.0.1
curl http://120.55.70.199
```

### 4. æ£€æŸ¥é˜²ç«å¢™

ç¡®ä¿é˜²ç«å¢™å…è®¸ 80 ç«¯å£ï¼š

```bash
# Ubuntu/Debian (UFW)
sudo ufw status
sudo ufw allow 80/tcp

# CentOS/RHEL (firewalld)
sudo firewall-cmd --list-all
sudo firewall-cmd --permanent --add-service=http
sudo firewall-cmd --reload
```

## â˜ï¸ äº‘æœåŠ¡å™¨ç‰¹åˆ«æé†’

å¦‚æœä½ ä½¿ç”¨çš„æ˜¯äº‘æœåŠ¡å™¨ï¼ˆé˜¿é‡Œäº‘ã€è…¾è®¯äº‘ã€AWS ç­‰ï¼‰ï¼Œè¿˜éœ€è¦ï¼š

### 1. é…ç½®å®‰å…¨ç»„è§„åˆ™

åœ¨äº‘å¹³å°æ§åˆ¶å°é…ç½®å®‰å…¨ç»„ï¼Œå…è®¸ä»¥ä¸‹ç«¯å£ï¼š
- **80** (HTTP) - å¿…éœ€
- **443** (HTTPS) - å¦‚æœå°†æ¥é…ç½® SSL
- **8000** - å¦‚æœç›´æ¥è®¿é—®åº”ç”¨ï¼ˆä¸ä½¿ç”¨ Nginxï¼‰

### 2. ç¡®è®¤æœåŠ¡å™¨æœ‰å…¬ç½‘ IP

ç¡®è®¤ä½ çš„æœåŠ¡å™¨å·²åˆ†é…å…¬ç½‘ IPï¼š`120.55.70.199`

## ğŸš¨ å¦‚æœæ— æ³•è®¿é—®

### æ’æŸ¥æ­¥éª¤

```bash
# 1. æ£€æŸ¥æ‰€æœ‰æœåŠ¡çŠ¶æ€
sudo systemctl status qk-paper-search
sudo systemctl status nginx

# 2. æ£€æŸ¥ç«¯å£ç›‘å¬
sudo netstat -tlnp | grep 8000  # åº”ç”¨ç«¯å£
sudo netstat -tlnp | grep 80    # HTTP ç«¯å£

# 3. æŸ¥çœ‹æ—¥å¿—
sudo journalctl -u qk-paper-search -n 50
sudo tail -f /var/log/nginx/error.log

# 4. æµ‹è¯•æœ¬åœ°è®¿é—®
curl http://127.0.0.1:8000  # åº”ç”¨
curl http://127.0.0.1       # Nginx
```

### å¸¸è§é—®é¢˜

1. **502 Bad Gateway**
   - æ£€æŸ¥åº”ç”¨æœåŠ¡æ˜¯å¦è¿è¡Œï¼š`sudo systemctl restart qk-paper-search`

2. **è¿æ¥è¶…æ—¶**
   - æ£€æŸ¥é˜²ç«å¢™è§„åˆ™
   - æ£€æŸ¥äº‘æœåŠ¡å™¨å®‰å…¨ç»„é…ç½®

3. **403 Forbidden**
   - æ£€æŸ¥ Nginx é…ç½®ï¼š`sudo nginx -t`
   - æ£€æŸ¥æ–‡ä»¶æƒé™

## ğŸ“š ç›¸å…³æ–‡æ¡£

- [å¦‚ä½•è®¿é—®åº”ç”¨.md](å¦‚ä½•è®¿é—®åº”ç”¨.md) - è¯¦ç»†è®¿é—®æŒ‡å—
- [å¦‚ä½•ä¿®æ”¹Nginxé…ç½®.md](å¦‚ä½•ä¿®æ”¹Nginxé…ç½®.md) - Nginx é…ç½®è¯´æ˜
- [DEPLOYMENT.md](DEPLOYMENT.md) - å®Œæ•´éƒ¨ç½²æ–‡æ¡£

---

**å¿«é€Ÿé…ç½®å‘½ä»¤**ï¼ˆå¤åˆ¶ç²˜è´´è¿è¡Œï¼‰ï¼š

```bash
# ä¸€é”®é…ç½®å¹¶é‡æ–°åŠ è½½
sudo sed -i 's/server_name.*;/server_name _;/' /etc/nginx/sites-available/qk-paper-search && \
sudo nginx -t && \
sudo systemctl reload nginx && \
echo "é…ç½®å®Œæˆï¼ç°åœ¨å¯ä»¥é€šè¿‡ http://120.55.70.199 è®¿é—®"
```




