# ä¸€é”®ä¿®å¤è„šæœ¬ä½¿ç”¨è¯´æ˜Ž

## ðŸ“ è„šæœ¬æ–‡ä»¶

**fix-nginx-site.sh** - ä¸€é”®ä¿®å¤ Nginx "æ²¡æœ‰æ‰¾åˆ°ç«™ç‚¹" é”™è¯¯

## ðŸš€ ä½¿ç”¨æ–¹æ³•

### æ–¹æ³• 1ï¼šç›´æŽ¥è¿è¡Œï¼ˆæŽ¨èï¼‰

```bash
# 1. ä¸Šä¼ è„šæœ¬åˆ°æœåŠ¡å™¨ï¼ˆæˆ–ç›´æŽ¥åœ¨æœåŠ¡å™¨ä¸Šåˆ›å»ºï¼‰
# 2. æ·»åŠ æ‰§è¡Œæƒé™
chmod +x fix-nginx-site.sh

# 3. è¿è¡Œè„šæœ¬ï¼ˆéœ€è¦ root æƒé™ï¼‰
sudo ./fix-nginx-site.sh
```

### æ–¹æ³• 2ï¼šä½¿ç”¨ bash ç›´æŽ¥è¿è¡Œ

```bash
# ä¸éœ€è¦æ·»åŠ æ‰§è¡Œæƒé™ï¼Œç›´æŽ¥ç”¨ bash è¿è¡Œ
sudo bash fix-nginx-site.sh
```

## âœ¨ è„šæœ¬åŠŸèƒ½

è¿™ä¸ªè„šæœ¬ä¼šè‡ªåŠ¨å®Œæˆä»¥ä¸‹æ“ä½œï¼š

1. âœ… **æ£€æŸ¥å¹¶å®‰è£… Nginx**ï¼ˆå¦‚æžœæœªå®‰è£…ï¼‰
2. âœ… **æ£€æŸ¥é…ç½®æ–‡ä»¶æ˜¯å¦å­˜åœ¨**
3. âœ… **åˆ›å»ºå¿…è¦çš„ç›®å½•**
4. âœ… **ä¿®æ”¹ server_name ä¸º `_`**ï¼ˆåŒ¹é…æ‰€æœ‰è®¿é—®ï¼‰
5. âœ… **åˆ›å»ºç«™ç‚¹è½¯é“¾æŽ¥**ï¼ˆå¯ç”¨ç«™ç‚¹ï¼‰
6. âœ… **ç¦ç”¨é»˜è®¤ç«™ç‚¹**ï¼ˆé¿å…å†²çªï¼‰
7. âœ… **æµ‹è¯•å¹¶é‡æ–°åŠ è½½ Nginx**
8. âœ… **æ£€æŸ¥å¹¶å¯åŠ¨åº”ç”¨æœåŠ¡**

## ðŸ“‹ ä¿®å¤å†…å®¹

è„šæœ¬ä¼šä¿®å¤ä»¥ä¸‹é—®é¢˜ï¼š

- âŒ `server_name` é…ç½®ä¸æ­£ç¡® â†’ âœ… æ”¹ä¸º `server_name _;`
- âŒ ç«™ç‚¹æœªå¯ç”¨ï¼ˆç¼ºå°‘è½¯é“¾æŽ¥ï¼‰â†’ âœ… åˆ›å»ºè½¯é“¾æŽ¥
- âŒ é»˜è®¤ç«™ç‚¹å¹²æ‰° â†’ âœ… ç¦ç”¨é»˜è®¤ç«™ç‚¹
- âŒ Nginx é…ç½®æœªç”Ÿæ•ˆ â†’ âœ… é‡æ–°åŠ è½½é…ç½®

## ðŸ” è¿è¡Œå‰æ£€æŸ¥

åœ¨è¿è¡Œè„šæœ¬å‰ï¼Œç¡®ä¿ï¼š

- [ ] å·²ä¸Šä¼ é¡¹ç›®æ–‡ä»¶åˆ°æœåŠ¡å™¨
- [ ] å·²è¿è¡Œè¿‡éƒ¨ç½²è„šæœ¬ï¼ˆæˆ–æ‰‹åŠ¨åˆ›å»ºäº† Nginx é…ç½®æ–‡ä»¶ï¼‰
- [ ] æœ‰ root æˆ– sudo æƒé™

## ðŸ“ è„šæœ¬è¾“å‡ºç¤ºä¾‹

è¿è¡Œè„šæœ¬åŽï¼Œä½ ä¼šçœ‹åˆ°ç±»ä¼¼è¾“å‡ºï¼š

```
========================================
å¼€å§‹ä¿®å¤ Nginx é…ç½®...
========================================
[1/7] æ£€æŸ¥ Nginx æ˜¯å¦å®‰è£…...
Nginx å·²å®‰è£…
[2/7] æ£€æŸ¥é…ç½®æ–‡ä»¶...
é…ç½®æ–‡ä»¶å­˜åœ¨
[3/7] æ£€æŸ¥å¹¶åˆ›å»ºç›®å½•...
ç›®å½•æ£€æŸ¥å®Œæˆ
[4/7] ä¿®æ”¹ server_name é…ç½®...
server_name å·²ä¿®æ”¹ä¸º _ (åŒ¹é…æ‰€æœ‰)
[5/7] åˆ›å»ºç«™ç‚¹è½¯é“¾æŽ¥...
è½¯é“¾æŽ¥å·²åˆ›å»º
[6/7] æ£€æŸ¥é»˜è®¤ç«™ç‚¹...
é»˜è®¤ç«™ç‚¹å·²ç¦ç”¨
[7/7] æµ‹è¯•å¹¶é‡æ–°åŠ è½½ Nginx...
Nginx é…ç½®å·²é‡æ–°åŠ è½½
[é¢å¤–] æ£€æŸ¥åº”ç”¨æœåŠ¡...
åº”ç”¨æœåŠ¡æ­£åœ¨è¿è¡Œ
========================================
ä¿®å¤å®Œæˆï¼
========================================
```

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **éœ€è¦ root æƒé™**ï¼šè„šæœ¬éœ€è¦ä½¿ç”¨ `sudo` è¿è¡Œ
2. **ä¼šå¤‡ä»½é…ç½®**ï¼šä¿®æ”¹å‰ä¼šè‡ªåŠ¨å¤‡ä»½åŽŸé…ç½®æ–‡ä»¶
3. **ä¼šç¦ç”¨é»˜è®¤ç«™ç‚¹**ï¼šå¦‚æžœå­˜åœ¨é»˜è®¤ç«™ç‚¹ï¼Œä¼šè¢«é‡å‘½åå¤‡ä»½

## ðŸ”§ æ‰‹åŠ¨åˆ›å»ºè„šæœ¬ï¼ˆå¦‚æžœæ— æ³•ä¸Šä¼ ï¼‰

å¦‚æžœæ— æ³•ä¸Šä¼ è„šæœ¬æ–‡ä»¶ï¼Œå¯ä»¥åœ¨æœåŠ¡å™¨ä¸Šç›´æŽ¥åˆ›å»ºï¼š

```bash
# åˆ›å»ºè„šæœ¬æ–‡ä»¶
cat > fix-nginx-site.sh << 'SCRIPT_END'
#!/bin/bash
# ... (è„šæœ¬å†…å®¹)
SCRIPT_END

# æ·»åŠ æ‰§è¡Œæƒé™
chmod +x fix-nginx-site.sh

# è¿è¡Œ
sudo ./fix-nginx-site.sh
```

æˆ–è€…ç›´æŽ¥å¤åˆ¶è„šæœ¬å†…å®¹åˆ°æœåŠ¡å™¨ï¼Œç„¶åŽè¿è¡Œã€‚

## ðŸš¨ å¦‚æžœè„šæœ¬è¿è¡Œå¤±è´¥

å¦‚æžœè„šæœ¬è¿è¡Œå¤±è´¥ï¼Œå¯ä»¥ï¼š

1. **æŸ¥çœ‹é”™è¯¯ä¿¡æ¯**ï¼šè„šæœ¬ä¼šæ˜¾ç¤ºå…·ä½“çš„é”™è¯¯
2. **æ‰‹åŠ¨æ‰§è¡Œæ­¥éª¤**ï¼šå‚è€ƒ [è§£å†³æ²¡æœ‰æ‰¾åˆ°ç«™ç‚¹é”™è¯¯.md](è§£å†³æ²¡æœ‰æ‰¾åˆ°ç«™ç‚¹é”™è¯¯.md)
3. **æ£€æŸ¥æ—¥å¿—**ï¼š
   ```bash
   sudo tail -f /var/log/nginx/error.log
   sudo journalctl -u qk-paper-search -n 50
   ```

## ðŸ“š ç›¸å…³æ–‡æ¡£

- [è§£å†³æ²¡æœ‰æ‰¾åˆ°ç«™ç‚¹é”™è¯¯.md](è§£å†³æ²¡æœ‰æ‰¾åˆ°ç«™ç‚¹é”™è¯¯.md) - è¯¦ç»†æ•…éšœæŽ’æŸ¥
- [å¦‚ä½•è®¿é—®åº”ç”¨.md](å¦‚ä½•è®¿é—®åº”ç”¨.md) - è®¿é—®åº”ç”¨çš„æ–¹æ³•
- [æ•…éšœæŽ’é™¤æ¸…å•.md](æ•…éšœæŽ’é™¤æ¸…å•.md) - å…¶ä»–å¸¸è§é—®é¢˜

---

**å¿«é€Ÿä½¿ç”¨**ï¼š
```bash
chmod +x fix-nginx-site.sh && sudo ./fix-nginx-site.sh
```




