# 宝塔面板添加站点指南

## 📋 通过宝塔面板图形界面添加站点

### 方法 1：添加新站点并配置反向代理（推荐）

#### 步骤 1：登录宝塔面板

1. 在浏览器访问你的宝塔面板地址（通常是 `http://服务器IP:8888`）
2. 输入用户名和密码登录

#### 步骤 2：添加站点

1. **点击左侧菜单"网站"**
2. **点击"添加站点"按钮**（通常在右上角）
3. **填写站点信息**：
   - **域名**：填写 `120.55.70.199` 或留空（如果只通过 IP 访问）
   - **备注**：填写 `论文搜索系统`（可选）
   - **网站目录**：选择或填写 `/opt/qk`（如果不存在会自动创建）
   - **FTP**：不创建（可选）
   - **数据库**：不创建（可选）
   - **PHP版本**：纯静态（因为我们使用 Python，不需要 PHP）
4. **点击"提交"**

#### 步骤 3：配置反向代理

1. **在站点列表中，找到刚创建的站点**
2. **点击站点右侧的"设置"按钮**
3. **点击左侧菜单"反向代理"**
4. **点击"添加反向代理"**
5. **填写反向代理信息**：
   - **代理名称**：填写 `app`（任意名称）
   - **目标URL**：填写 `http://127.0.0.1:8000`
   - **发送域名**：选择 `$host`
   - **其他选项**：保持默认
6. **点击"提交"**

#### 步骤 4：配置静态文件（可选）

1. **在站点设置中，点击"网站目录"**
2. **设置网站运行目录**：`/opt/qk`
3. **取消勾选"防跨站攻击"**（如果启用可能影响静态文件）
4. **点击"保存"**

### 方法 2：手动编辑配置文件（高级用户）

如果已经通过脚本创建了配置文件，可以直接在宝塔面板中查看和编辑：

#### 步骤 1：查看配置文件

1. **登录宝塔面板**
2. **点击"文件"菜单**
3. **导航到**：`/www/server/panel/vhost/nginx/`
4. **找到**：`qk-paper-search.conf`
5. **点击文件名进行查看或编辑**

#### 步骤 2：在网站列表中查看

1. **点击"网站"菜单**
2. **在站点列表中应该能看到站点**（如果配置文件格式正确）
3. **点击"设置"可以进行管理**

## 🔧 通过宝塔面板管理站点

### 查看站点列表

1. 登录宝塔面板
2. 点击左侧"网站"
3. 在列表中可以看到所有站点及其状态

### 编辑站点配置

1. 在站点列表中，点击站点右侧的"设置"
2. 可以进行以下操作：
   - **网站目录**：修改网站根目录
   - **反向代理**：添加/编辑反向代理
   - **SSL**：配置 HTTPS 证书
   - **域名管理**：添加/删除域名
   - **性能优化**：缓存、压缩等设置

### 重启/重载 Nginx

1. **方法 1：通过软件商店**
   - 点击"软件商店"
   - 找到 Nginx
   - 点击"设置"
   - 点击"重启"或"重载配置"

2. **方法 2：通过网站菜单**
   - 点击"网站"
   - 点击任意站点右侧的"设置"
   - 在设置页面右上角有"重载配置"按钮

## 📝 配置文件位置

宝塔面板的站点配置文件位置：

```
/www/server/panel/vhost/nginx/
├── qk-paper-search.conf    # 你的站点配置
└── 其他站点.conf           # 其他站点配置
```

## 🎯 快速操作步骤总结

### 通过图形界面添加（最直观）

```
1. 登录宝塔面板
2. 网站 → 添加站点
3. 填写信息：
   - 域名：120.55.70.199（或留空）
   - 网站目录：/opt/qk
   - PHP版本：纯静态
4. 提交
5. 网站 → 找到站点 → 设置 → 反向代理 → 添加
6. 目标URL：http://127.0.0.1:8000
7. 提交
```

### 如果已经通过脚本创建了配置

```
1. 登录宝塔面板
2. 网站 → 查看站点列表（应该能看到站点）
3. 点击站点 → 设置 → 可以查看/编辑配置
```

## 🔍 验证配置

### 在宝塔面板中验证

1. **查看站点列表**：网站菜单中应该能看到站点
2. **查看配置文件**：网站 → 设置 → 配置文件，查看内容是否正确
3. **查看反向代理**：网站 → 设置 → 反向代理，确认已配置

### 通过命令行验证

```bash
# 查看配置文件
cat /www/server/panel/vhost/nginx/qk-paper-search.conf

# 测试 Nginx 配置
/www/server/nginx/sbin/nginx -t

# 查看 Nginx 进程
ps aux | grep nginx

# 测试访问
curl http://127.0.0.1
```

## 🚨 常见问题

### 问题 1：在站点列表中看不到站点

**原因**：配置文件格式不对或未正确加载

**解决**：
```bash
# 检查配置文件是否存在
ls -la /www/server/panel/vhost/nginx/qk-paper-search.conf

# 检查配置格式
/www/server/nginx/sbin/nginx -t

# 重新加载 Nginx
/www/server/nginx/sbin/nginx -s reload
```

### 问题 2：反向代理不生效

**检查**：
1. 在宝塔面板中查看反向代理配置
2. 确认目标URL正确：`http://127.0.0.1:8000`
3. 确认应用服务正在运行：`systemctl status qk-paper-search`

### 问题 3：静态文件无法访问

**解决**：
1. 在站点设置中，检查网站目录是否正确
2. 取消勾选"防跨站攻击"
3. 确认静态文件目录权限：`chmod -R 755 /opt/qk/static`

## 📚 相关文档

- [部署到宝塔面板-完整步骤.md](部署到宝塔面板-完整步骤.md) - 完整部署步骤
- [fix-bt-nginx-site.sh](fix-bt-nginx-site.sh) - 自动配置脚本
- [宝塔面板Nginx配置说明.md](宝塔面板Nginx配置说明.md) - 配置说明

---

**快速操作**：
1. 登录宝塔面板
2. 网站 → 添加站点
3. 填写信息并添加反向代理到 `http://127.0.0.1:8000`




